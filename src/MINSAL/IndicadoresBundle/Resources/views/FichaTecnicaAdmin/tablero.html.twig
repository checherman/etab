{# Modificado para que agregar el botón para ir al listado #}

{% extends 'IndicadoresBundle::standard_layout.html.twig' %}
{% block stylesheets %}
    {{ parent() }}
<link rel="stylesheet" href="{{ asset('bundles/indicadores/css/FichaTecnicaAdmin/tablero.css') }}" type="text/css" media="all" />
<link rel="stylesheet" href="{{ asset('bundles/indicadores/js/DataTables/media/css/jquery.dataTables.css') }}" type="text/css" media="all" />
<link rel="stylesheet" href="{{ asset('bundles/indicadores/js/DataTables/media/css/TableTools.css') }}" type="text/css" media="all" />

<!--EDITADO PARA NUEVOS TIPOS DE GRAFICOS (CSS)-->
    <link rel="stylesheet" href="{{ asset('bundles/indicadores/css/FichaTecnicaAdmin/gauge.css') }}" type="text/css" media="all" />


{% endblock %}

{% block javascripts %}
    {{ parent() }}
<script src="{{ asset('bundles/indicadores/js/d3.v2.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/nv.d3.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/affix.min.js') }}" type="text/javascript"></script>

<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/comun.js') }}" type="text/javascript"></script>
    <!--EDITADO PARA NUEVOS TIPOS DE GRAFICOS-->
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_gauge.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_termometro.js') }}" type="text/javascript"></script>
    <script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/iopctrl.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_pastel.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_columnas.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_lineas.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/grafico_mapa.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/tablero.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/bridge_draggable_touch.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/jquery.ui.touch-punch.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/rasterizeHTML.allinone.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/DataTables/jquery.dataTables.min.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/DataTables/ZeroClipboard.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/DataTables/TableTools.min.js') }}" type="text/javascript"></script>

<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/svg-pan-zoom.js') }}" type="text/javascript"></script>
<script src="{{ asset('bundles/indicadores/js/FichaTecnicaAdmin/control-icons.js') }}" type="text/javascript"></script>

<script>
$(document).ready(function(){
	$("#search_").autocomplete({
		source: "{{ path('autoComplete_Indicador') }}",
		select: function (a, b) 
				{
					var valor=b.item.value;
					valor=valor.split("]")[0];
					valor=valor.split("[")[1];	
					sala_agregar_fila(); 								
					recuperarDimensiones(valor, null);
				},
	});
	$('#search_').click(function() {
        this.value="";
    });
	
});
function sala_agregar_fila() {
	var cant = $('DIV.area_grafico').length;
	var html =  '<div class="area_grafico zona_actual" id="grafico_' + parseInt(cant+1) + '" >' +
					"<DIV class= 'titulo'><span class='titulo_indicador '></span>"+
						"<span>("+trans.por+" <span class='dimension' ></span>)</span>"+
					'</DIV>'+
					'<h6 class="filtros_dimensiones"></h6>' +
					'<div class="controles btn-toolbar" style="margin-bottom:30px"></div>' +
					'<div class="info" ></div>' +
					'<div class="row_grafico" >' +
						'<div class="grafico" ></div>' +
					'</div>' +                        
				'</DIV>';         

	$('#sala').append(html);        
	$('DIV.area_grafico').click(function() {
		zona_elegir(this);
	});
}
function maximizar()
{		
		var windowH = $(window).height();
        $('#menu_sala .dropdown-submenu .dropdown-menu').css({'max-height':($(window).height()-300)+'px'});
        $('#menu_sala .dropdown-submenu .dropdown-menu').css({'overflow':'auto'});
        
        $('.ui-autocomplete').css({'max-height':($(window).height()-300)+'px'});
        $('.ui-autocomplete').css({'overflow':'auto'});
}
window.onresize=maximizar;
window.onload=maximizar;
</script>
<style>
.ui-autocomplete { max-height: 200px; overflow:auto;}
</style>
{% endblock %}

{% block content %}
<div id="div_carga" class='affix'>
    <img id="cargador" src="{{ asset('bundles/indicadores/images/ajax-loader.gif') }}"/>
</div>

{% if is_mobile() %}
    {% include 'IndicadoresBundle:FichaTecnicaAdmin:menu_tablero_mobile.html.twig' %}
{% else %}
    {% include 'IndicadoresBundle:FichaTecnicaAdmin:menu_tablero.html.twig' %}
{% endif %}

<div id='nombre_sala2' ></div>
<div class="content" id="sala" >
    
</div>

<!-- Modal -->

<div id="myModal" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
        <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
            <h3 id="myModalLabel">{{'_sala_situacional_'|trans}}</h3>
        </div>
    
        <div class="modal-body">
            <label for="nombre_sala">{{'_nombre_sala_'|trans}}</label>
            <textarea id='nombre_sala' id-sala='' rows="3" style="width: 90%"></textarea>
            <span class='info' id='info_sala'></span>
        </div>
    
        <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">{{'_cerrar_'|trans}}</button>
            <button id='guardar_sala' class="btn btn-primary">{{'_guardar_cambios_'|trans}}</button>
        </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->

<div id="myModal2" class="modal fade">
  <div class="modal-dialog">
    <div class="modal-content">
       <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
        <h3 id="myModalLabel2"></h3>
    	</div>
        <div class="modal-body" style="max-height:400px; max-width:100%; overflow:auto;">
        <span class='info' id='sql'></span>
        </div>
        <div class="modal-footer">
        <button class="btn" data-dismiss="modal" aria-hidden="true">{{'_cerrar_'|trans}}</button>
        </div>
    </div><!-- /.modal-content -->
  </div><!-- /.modal-dialog -->
</div><!-- /.modal -->
{% endblock %}
